<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Space-Filling Random and Quasi-Random Sequences • spacefillr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Space-Filling Random and Quasi-Random Sequences">
<meta property="og:description" content='Generates random and quasi-random space-filling sequences. Supports the following sequences: Halton, Sobol, Owen-scrambled Sobol, progressive jittered, progressive multi-jittered (PMJ), PMJ with blue noise, PMJ02, and PMJ02 with blue noise. Includes a C++ API. Methods derived from "Constructing Sobol sequences with better two-dimensional projections" (2012) &lt;doi:10.1137/070709359&gt; S. Joe and F. Y. Kuo, and "Progressive Multi-Jittered Sample Sequences" (2018) &lt;https://graphics.pixar.com/library/ProgressiveMultiJitteredSampling/paper.pdf&gt; Christensen, P., Kensler, A. and Kilpatrick, C. '>
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">spacefillr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tylermorganwall/spacefillr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="spacefillr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#spacefillr" class="anchor"></a>spacefillr</h1></div>
<!-- badges: start -->

<p>spacefillr is a package for generating random and quasi-random space-filling sequences. Supports the following sequences: ‘Halton’, ‘Sobol’, ‘Owen’-scrambled ‘Sobol’, progressive jittered, progressive multi-jittered (‘PMJ’), ‘PMJ’ with blue noise, ‘PMJ02’, and ‘PMJ02’ with blue noise. Includes a ‘C++’ ‘API’. Methods derived from “Constructing Sobol sequences with better two-dimensional projections” (2012) S. Joe and F. Y. Kuo, and “Progressive Multi‐Jittered Sample Sequences” (2018) Christensen, P., Kensler, A. and Kilpatrick, C.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of spacefillr from Github with the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"tylermorganwall/spacefillr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>Generating random sequences is an important topic when trying to solve problems using Monte Carlo methods. Careful choice of the correct random (or quasi-random) sequence can result in much faster convergence to the final answer. Let’s take the problem of solving for the value of Pi by counting the number of values that fall within the unit circle. If we generate random values between 0 and 1, count how many fall within the unit circle, multiply by 4 and divide by the number of samples, we will get an estimate for Pi.</p>
<p>Let’s first try this with purely uniform random numbers:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">results_rand</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">results_rand</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>

<span class="va">results_rand</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,color<span class="op">=</span><span class="va">inside</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>We can plot the convergence:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_rand_convergence</span> <span class="op">=</span> <span class="va">results_rand</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span>, iteration <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>pi_estimate <span class="op">=</span> <span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">inside</span><span class="op">)</span><span class="op">/</span><span class="va">iteration</span><span class="op">)</span> 

<span class="fu">ggplot</span><span class="op">(</span><span class="va">results_rand_convergence</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">pi</span>, alpha<span class="op">=</span><span class="fl">0.25</span>,color<span class="op">=</span><span class="st">"black"</span>,size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-convergence1-1.png" width="100%"></p>
<p>Uniform random numbers, however, have poor convergence properties. We can do better by using spacefillr to generate sequences that are more evenly distributed throughout space, which helps these Monte Carlo integrals converge more quickly.</p>
<p>We’ll first start with a Halton sequence:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tylermorganwall/spacefillr">spacefillr</a></span><span class="op">)</span>

<span class="va">results_halton</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/generate_halton_random_set.html">generate_halton_random_set</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">results_halton</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>

<span class="va">results_halton</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,color<span class="op">=</span><span class="va">inside</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-halton-1.png" width="100%"></p>
<p>These samples are much more evenly distributed. Let’s compare the convergence of this sequence to random uniform numbers:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_halton_convergence</span> <span class="op">=</span> <span class="va">results_halton</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span>, iteration <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>pi_estimate <span class="op">=</span> <span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">inside</span><span class="op">)</span><span class="op">/</span><span class="va">iteration</span><span class="op">)</span> 

<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">pi</span>, alpha<span class="op">=</span><span class="fl">0.25</span>,color<span class="op">=</span><span class="st">"black"</span>,size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_rand_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_halton_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-convergence2-1.png" width="100%"></p>
<p>We can see this set of quasi-random numbers converges significantly faster than random uniform. Let’s now use the gold-standard quasi-random sequence: Owen-scrambled Sobol. (note: another function <code><a href="reference/generate_sobol_owen_fast_set.html">generate_sobol_owen_fast_set()</a></code> is also included in the package that outputs near-ideal Owen scrambled Sobol numbers, but is much faster).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_owen_sobol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/generate_sobol_owen_set.html">generate_sobol_owen_set</a></span><span class="op">(</span><span class="fl">1000</span>,<span class="fl">2</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">results_owen_sobol</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>

<span class="va">results_owen_sobol</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,color<span class="op">=</span><span class="va">inside</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-sobol-1.png" width="100%"></p>
<p>Let’s look at the convergence properties of this set.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_owen_sobol_convergence</span> <span class="op">=</span> <span class="va">results_owen_sobol</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span>, iteration <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>pi_estimate <span class="op">=</span> <span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">inside</span><span class="op">)</span><span class="op">/</span><span class="va">iteration</span><span class="op">)</span> 

<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">pi</span>, alpha<span class="op">=</span><span class="fl">0.25</span>,color<span class="op">=</span><span class="st">"black"</span>,size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_rand_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_halton_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_owen_sobol_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"green"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 3 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="reference/figures/README-convergence3-1.png" width="100%"></p>
<p>Owen-scrambled Sobol converges the fastest out of all of the sequences. Also included are the progressive multijittered sequences, of which pmj02 has similar convergence properties to Owen-scrambled Sobol.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_owen_pmj02</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/generate_pmj02_set.html">generate_pmj02_set</a></span><span class="op">(</span><span class="fl">1000</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">results_owen_pmj02</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>

<span class="va">results_owen_pmj02</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,color<span class="op">=</span><span class="va">inside</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-pmj02-1.png" width="100%"></p>
<p>We can compare this to Owen-scrambled Sobol:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_owen_pmj02_convergence</span> <span class="op">=</span> <span class="va">results_owen_pmj02</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span>, iteration <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>pi_estimate <span class="op">=</span> <span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">inside</span><span class="op">)</span><span class="op">/</span><span class="va">iteration</span><span class="op">)</span> 

<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">pi</span>, alpha<span class="op">=</span><span class="fl">0.25</span>,color<span class="op">=</span><span class="st">"black"</span>,size<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_owen_pmj02_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"purple"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span>data<span class="op">=</span><span class="va">results_owen_sobol_convergence</span>,<span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">iteration</span>,y<span class="op">=</span><span class="va">pi_estimate</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"green"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_y_continuous</span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.4</span>,<span class="fl">3.6</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span>

<span class="co">#&gt; Warning: Removed 2 row(s) containing missing values (geom_path).</span></code></pre></div>
<p><img src="reference/figures/README-convergence4-1.png" width="100%"></p>
<p>An interesting properties of pmj02 sequences (absent from Sobol sequences) is that they can be generated with blue noise properties.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_owen_pmj02bn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="reference/generate_pmj02bn_set.html">generate_pmj02bn_set</a></span><span class="op">(</span><span class="fl">1000</span>,seed<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">results_owen_pmj02bn</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span>

<span class="va">results_owen_pmj02bn</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>inside <span class="op">=</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">y</span><span class="op">^</span><span class="fl">2</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,y<span class="op">=</span><span class="va">y</span>,color<span class="op">=</span><span class="va">inside</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_fixed</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-pmj02bn-1.png" width="100%"></p>
<p>This does not help convergence, but has some applications in some types of Monte Carlo problems.</p>
</div>
<div id="c-api" class="section level2">
<h2 class="hasAnchor">
<a href="#c-api" class="anchor"></a>C++ API</h2>
<p>This package also includes a C++ API for accessing Halton and Sobol sequences, which allows you to generate these sequences quickly in your C++ code. You can access a halton sequence by creating a Halton object:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1"></a><span class="pp">#include </span><span class="im">"halton_sampler.h"</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>spacefillr::Halton_sampler hs;</span>
<span id="cb11-4"><a href="#cb11-4"></a>hs.init_faure();</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">//This generates the 10th value of the 2nd dimension of the Halton sequence</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="dt">double</span> val = hs.sample(<span class="dv">10</span>,<span class="dv">2</span>);</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">//This generates a 3D point in space</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="dt">double</span> val[<span class="dv">3</span>] = {hs.sample(<span class="dv">1</span>,<span class="dv">1</span>), hs.sample(<span class="dv">1</span>,<span class="dv">2</span>), hs.sample(<span class="dv">1</span>,<span class="dv">3</span>)};</span></code></pre></div>
<p>To access Sobol values, call the following functions (no object is needed):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1"></a><span class="pp">#include </span><span class="im">"sobol.h"</span></span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">//Sobol, no Owen-scrambling: 1st value, 10th dimension</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="dt">double</span> val1 = spacefillr::sobol_single(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">//Slow (but highest quality) generator: 1st value, 10th dimension,  setting the random seed for that sequence to 1234</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="dt">double</span> val2 = spacefillr::sobol_owen_reference_single(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1234</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">//Fast generator: 1st value, 10th dimension,  setting the random seed for that sequence to 1234</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="dt">double</span> val3 = spacefillr::sobol_owen_fast_single(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1234</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">//This generates a 3D point in space</span></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="dt">double</span> val[<span class="dv">3</span>] = {spacefillr::sobol_owen_fast_single(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb12-14"><a href="#cb12-14"></a>                 spacefillr::sobol_owen_fast_single(<span class="dv">1</span>,<span class="dv">2</span>, <span class="dv">10</span>), </span>
<span id="cb12-15"><a href="#cb12-15"></a>                 spacefillr::sobol_owen_fast_single(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">10</span>)};</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/tylermorganwall/spacefillr/">https://​github.com/​tylermorganwall/​spacefillr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/tylermorganwall/spacefillr/issues">https://​github.com/​tylermorganwall/​spacefillr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Tyler Morgan-Wall <br><small class="roles"> Author, copyright holder, maintainer </small> <a href="https://orcid.org/0000-0002-3131-3814" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tylermorganwall/spacefillr/actions"><img src="https://github.com/tylermorganwall/spacefillr/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://github.com/tylermorganwall/spacefillr/actions"><img src="https://github.com/tylermorganwall/spacefillr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Tyler Morgan-Wall.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
